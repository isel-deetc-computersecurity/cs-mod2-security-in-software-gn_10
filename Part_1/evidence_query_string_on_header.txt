HTTP/1.1 200 OK
Date: Tue, 28 Oct 2025 12:51:26 GMT
Server: Apache/2.4.41 (Ubuntu)
Vary: Accept-Encoding
Transfer-Encoding: chunked
Content-Type: text/plain

****** Environment Variables ******
HTTP_HOST=localhost:8080
HTTP_USER_AGENT=curl/8.14.1
HTTP_ACCEPT=*/*
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
SERVER_SIGNATURE=<address>Apache/2.4.41 (Ubuntu) Server at localhost Port 8080</address>
SERVER_SOFTWARE=Apache/2.4.41 (Ubuntu)
SERVER_NAME=localhost
SERVER_ADDR=172.17.0.2
SERVER_PORT=8080
REMOTE_ADDR=172.17.0.1
DOCUMENT_ROOT=/var/www/html
REQUEST_SCHEME=http
CONTEXT_PREFIX=/cgi-bin/
CONTEXT_DOCUMENT_ROOT=/usr/lib/cgi-bin/
SERVER_ADMIN=webmaster@localhost
SCRIPT_FILENAME=/usr/lib/cgi-bin/getenv.cgi
REMOTE_PORT=58722
GATEWAY_INTERFACE=CGI/1.1
SERVER_PROTOCOL=HTTP/1.1
REQUEST_METHOD=GET
QUERY_STRING=test_header=testing_header
REQUEST_URI=/cgi-bin/getenv.cgi?test_header=testing_header
SCRIPT_NAME=/cgi-bin/getenv.cgi



Não fazer um sheelshock bug com query string, pq a query string chega ao CGI como uma única variável QUERY_STRING (uma string do tipo a=1&b=2) — não é automaticamente transformada em variáveis de ambiente separadas que o bash iria interpretar. O bug Shellshock só é disparado quando uma variável de ambiente contém uma definição de função do tipo () { :; }; ..., e os cabeçalhos HTTP são convertidos pelo CGI em variáveis HTTP_* (onde esse payload pode ser colocado). Assim, pôr o payload na URL quase nunca funciona; usar um header (ex.: User-Agent) é o método que normalmente funciona.
